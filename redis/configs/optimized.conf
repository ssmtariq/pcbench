# redis_optimized_v3_fixed.conf
# High-performing config for YCSB-A on CloudLab xl170.
# - Keeps compact encodings (better spatial locality)
# - Faster cron (hz 100) for shorter rehash windows
# - Active defrag ON with tuned thresholds
# - IO threads disabled to avoid cross-core contention
# - Syntax valid for Redis 7.2+

############################
# Persistence / Logging
############################
appendonly no
aof-rewrite-incremental-fsync no
rdb-save-incremental-fsync no

############################
# Server cadence
############################
dynamic-hz yes
hz 100

############################
# Data-structure encodings
############################
hash-max-listpack-entries 2084
hash-max-listpack-value 2053
zset-max-listpack-entries 434
zset-max-listpack-value 344
set-max-intset-entries 418
list-compress-depth 3
list-max-listpack-size -2

############################
# Memory / fragmentation
############################
activedefrag yes
active-defrag-threshold-upper 29
active-defrag-threshold-lower 87
active-defrag-ignore-bytes 6054mb
active-defrag-max-scan-fields 5316
active-defrag-cycle-min 14
active-defrag-cycle-max 74
activerehashing no
jemalloc-bg-thread yes

############################
# Lazy frees
############################
lazyfree-lazy-eviction yes
lazyfree-lazy-expire yes
lazyfree-lazy-server-del no
lazyfree-lazy-user-del no
lazyfree-lazy-user-flush yes

############################
# Networking / I-O
############################
io-threads 1
io-threads-do-reads no

############################
# Eviction & misc
############################
maxmemory-policy volatile-random
hll-sparse-max-bytes 9772
lfu-decay-time 2
lfu-log-factor 6
stream-node-max-bytes 52847
stream-node-max-entries 704

# Optional niceties
latency-tracking yes
