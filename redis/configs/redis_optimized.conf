# redis_optimized.conf
# Reasonable, cache-friendly defaults for CloudLab xl170 based on HPCToolkit profiles (YCSB-A, update-heavy).
# Focus: reduce L2/L3 misses and allocator churn without source changes.

############### Persistence / background ###############
appendonly no
rdb-save-incremental-fsync no

############### Housekeeping cadence ###############
# Lower cron frequency to reduce background scans (expires, defrag, etc.).
dynamic-hz yes
hz 20

############### Data-structure encodings (convert earlier) ###############
# Convert hashes to hashtables earlier to avoid large listpack re-allocation/memmove.
hash-max-listpack-entries 256
hash-max-listpack-value 96

# Convert sorted sets earlier from listpack to skiplist/hashtable.
zset-max-listpack-entries 128
zset-max-listpack-value 64

# Favor default intset promotion for sets.
set-max-intset-entries 512

# Lists: avoid extra (de)compression overhead.
list-compress-depth 0
list-max-listpack-size -2

############### Memory management / fragmentation ###############
# Avoid background defrag memory scans that can pollute caches.
activedefrag no
activerehashing yes
jemalloc-bg-thread yes
lazyfree-lazy-eviction yes
lazyfree-lazy-expire yes
lazyfree-lazy-server-del no
lazyfree-lazy-user-del no
lazyfree-lazy-user-flush yes

############### Networking / I/O ###############
io-threads 5
io-threads-do-reads yes

############### Eviction (unused if no maxmemory) ###############
maxmemory-policy volatile-random

############### Misc ###############
hll-sparse-max-bytes 9772
lfu-decay-time 2
lfu-log-factor 6

# Streams (harmless if unused)
stream-node-max-bytes 52847
stream-node-max-entries 704
